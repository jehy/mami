<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Лабораторная #8 по Информационной безопасности</title>
    <link href="http://fonts.googleapis.com/css?family=Raleway:700,300" rel="stylesheet"
          type="text/css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/prettify.css">
</head>
<body>
<div class="wrapper">
    <nav>

        <div class="pull-left">
            <h1><a href="/mami"><img src="img/icon.png" alt="Free Documentation Template Icon"/>
                <span>Все материалы</span></a>
            </h1>
        </div>

        <div class="pull-right">

        </div>

    </nav>
    <header>
        <div class="container">
            <h2 class="lone-header">Лабораторная #8 по информационной безопасности</h2>
        </div>
    </header>
    <section>
        <div class="container">
            <ul class="docs-nav">
                <li><a href="#intro" class="cc-active">Введение</a></li>
                <li><a href="#tools" class="cc-active">Инструменты</a></li>
                <li><a href="#task" class="cc-active">Задание</a></li>
                <li><a href="#questions" class="cc-active">Вопросы</a></li>
                <li class="separator"></li>
            </ul>
            <div class="docs-content">
                <h2>Лабораторная работа №8. Тестирование веб приложения</h2>

                <b>Цель работы:</b> Научиться основным способам тестирования веб приложений


                <h3 id="intro">Введение</h3>
                <p>В ходе данной лабораторной работы мы будем искать уязвимости в специально предназначенном для
                    этого веб приложении из под названием DVWA. Damn Vulnerable Web Application - это
                    веб приложение на PHP/MySQL, которое "чертовски уязвимо". Его главное цель - помочь профессионалам
                    по
                    безопасности протестировать их навыки и инструменты в легальном окружении, помочь веб разработчикам
                    лучше понять процесс безопасности веб приложений и помочь и студентам и учителям в изучении
                    безопасности веб приложений в контролируемом окружении аудитории.</p>
                <p>Назначение DVWA - попрактиковаться в некоторых самых распространённых веб уязвимостях, с различными
                    уровнями
                    сложности, с простым прямолинейном интерфейсом. Обратите внимание, что имеются как
                    задокументированные, так и незадокументированные уязвимости в этом программном обеспечении. Это
                    сделано специально. Вам предлагается попробовать и обнаружить так много уязвимостей, как
                    сможете.</p>
                <b>ПРЕДУПРЕЖДЕНИЕ!</b>
                <p>Damn Vulnerable Web Application чертовски уязвимо! Не загружайте его в публичную html папку вашего
                    хостинг провайдера или на любой сервер, имеющий выход в Интернет, поскольку они будут
                    скомпрометированы. Рекомендуется использовать виртуальную машину (такую как VirtualBox или VMware),
                    которые установлены в сетевой режим NAT. Внутри гостевой машины вы можете загружать и установить
                    веб сервер и базы данных.</p>
                <h4 id="goal">Цель</h4>
                Цель работы - найти максимальное количество уязвимостей различных типов. Вот некоторые из уязвимостей
                веб приложений, который содержит DVWA:
                <ul>
                    <li>Брутфорс: Брутфорс HTTP формы страницы входа - используется для тестирования инструментов по
                        атаке на пароль методом грубой силы и показывает небезопасность слабых паролей.
                    </li>
                    <li>Исполнение (внедрение) команд: Выполнение команд уровня операционной системы.</li>
                    <li>Межсайтовая подделка запроса (CSRF): Позволяет «атакующему» изменить пароль администратора
                        приложений.
                    </li>
                    <li>Внедрение (инклуд) файлов: Позволяет «атакующему» присоединить удалённые/локальные файлы в
                        веб приложение.
                    </li>
                    <li>SQL внедрение: Позволяет «атакующему» внедрить SQL выражения в HTTP из поля ввода, DVWA включает
                        слепое и основанное на ошибке SQL внедрение.
                    </li>
                    <li>Небезопасная выгрузка файлов: Позволяет «атакующему» выгрузить вредоносные файлы на
                        веб сервер.
                    </li>
                    <li>Межсайтовый скриптинг (XSS): «Атакующий» может внедрить свои скрипты в веб приложение/базу
                        данных. DVWA включает отражённую и хранимую XSS.
                    </li>
                    <li>Пасхальные яйца: раскрытие полных путей, обход аутентификации и некоторые другие.</li>
                </ul>
                <h4>Уровни везопасности</h4>
                DVWA имеет три уровня безопасности, они меняют уровень безопасности каждого веб приложения в DVWA.
                <ul>
                    <li>Невозможный – этот уровень должен быть безопасным от всех уязвимостей. Он используется для
                        сравнения уязвимого исходного кода с безопасным исходным кодом. До DVWA v1.9 этот уровень был
                        известен как «высокий».
                    </li>
                    <li>Высокий - Это расширение среднего уровня сложности, со смесью более сложных или альтернативных
                        плохих практик в попытке обезопасить код. Уязвимости не позволяют такой простор эксплуатации как
                        на других уровнях.
                    </li>
                    <li>Средний - Этот уровень безопасности предназначен главным образом для того, чтобы дать
                        пользователю пример плохих практик безопасности, где разработчик попытался сделать приложение
                        безопасным, но потерпел неудачу. Он также выступает вызовом для пользователей, чтобы они
                        усовершенствовали свои техники эксплуатации.
                    </li>
                    <li>Низкий - Этот уровень безопасности совершенно уязвим и совсем не имеет защиты. Его
                        предназначение быть передовым примером среди уязвимых веб приложений, примером плохих практик
                        программирования и служить платформой обучения базовым техникам эксплуатации.
                    </li>
                </ul>
                <p>Каждая уязвимая страница в DVWA имеет кнопку 'view source' (показать исходный код), эта кнопка
                    используется для просмотра и сравнения исходного кода каждой уязвимости по сравнению с её безопасным
                    уровнем. Это позволяет пользователю с лёгкостью получить доступ к исходному коду для сравнения
                    безопасных и небезопасных практик написания кода.</p>
                <p>Также в DVWA вы можете включить или отключить PHP-IDS. PHP-IDS - это популярная PHP система
                    обнаружения вторжений (IDS), которые также известны как файерволы
                    веб приложений (Web Application Firewall (WAF)). PHP-IDS работает посредством фильтрации по чёрному
                    списку потенциально уязвимого кода любого пользовательского ввода. PHP-IDS используется в DVWA для
                    служения живым примером, как WAF может помочь улучшить безопасность в веб приложениях, а в Damn
                    Vulnerable Web Application (DVWA) - случае, как WAF можно обойти. PHP-IDS может быть включена или
                    отключена одним кликом по соответствующей кнопке.</p>
                <h4>Установка</h4>
                <p>DVWA может быть установлена в любую систему, где присутствуют Apache, PHP и MySQL, в том числе и в
                    Windows. Краткая инструкция по установке есть в задании, полная - в описании репозитория.</p>
                <h3 id="tools">Инструменты</h3>
                <p>Для тестирования должен использоваться дистрибутив Kali Linux релиза не ниже 2016.2. Инструменты,
                    которыми можно воспользоваться (включая, но не ограничиваясь) перечислены ниже.</p>
                <h4>nikto</h4>
                Nikto это open source сканер веб серверов. Он сканирует:
                <ul>
                    <li>Более 6500 опасных скриптов CGI</li>
                    <li>Более 1250 просроченных версий серверного ПО</li>
                    <li>Известные проблемы более чем для 270 серверов</li>
                    <li>Наличие индексных файлов</li>
                    <li>Опции HTTP-сервера такие как TRACE</li>
                    <li>Установленное ПО на веб сервере</li>
                </ul>
                Плюсом идёт простота использования утилиты - достаточно просто написать
                <pre class="prettyprint lang-bash">nikto -h someWebSite.RU</pre>
                Стоит заметить, что Nikto спроектирован не как "скрытное" ПО, этот сканер работает быстро, но
                как только начнется сканирование сервера, его системные администраторы заметят массу записей в
                логах. Или сканирование заметят сервисы вроде fail2ban.

                <h4>SQLMap</h4>

                <p>
                    sqlmap &mdash; это инструмент с открытым исходным кодом для тестирования на проникновение, который
                    автоматизирует процесс выявления и эксплуатирования уязвимостей SQL-инъекций и захват серверов баз
                    данных. Он поставляется с мощным движком выявления и многими нишевыми функциями для конечного
                    тестера на проникновение и широким набором переключателей начиная от отпечатков баз данных по
                    данным, полученным от этой БД, до доступа к файловой системе и выполнения команда на операционной
                    системе посредством внеполосных подключений.
                </p>
                <p>
                    Особенности
                </p>
                <ul>
                    <li>
                        Полная поддержка для таких систем управления базами данных как MySQL, Oracle, PostgreSQL,
                        Microsoft SQL Server, Microsoft Access, IBM DB2, SQLite, Firebird, Sybase, SAP MaxDB и HSQLDB.
                    </li>
                    <li>
                        Полная поддержка шести техник SQL-инхекций: слепая логическая (boolean-based blind), слепая,
                        основанная на времени (time-based blind), основанная на ошибке (error-based), основанная на
                        запросе UNION (UNION query-based), многоярусные запросы (stacked queries) и внеполосная
                        (out-of-band).
                    </li>
                    <li>
                        Поддержка прямого подключения к базе данных без прохода через SQL инъекцию, посредством введения
                        учётных данных СУБД, IP адреса, порта и имени БД.
                    </li>
                    <li>
                        Поддержка перечисления пользователей, хешей паролей, привилегий, ролей, БД, таблиц и колонок.
                    </li>
                    <li>
                        Автоматическое распознавание форматов хешей паролей и предложение их взлома с использованием
                        атаки по словарю.
                    </li>
                    <li>
                        Поддержка сдампливания записей таблиц БД, диапазона записей или указанных колонок по
                        пользовательскому выбору.
                    </li>
                    <li>
                        Пользователь также может выбрать сдампливать только диапазон символов из каждой записи колонки.
                    </li>
                    <li>
                        Поддержка поиска указанных имён БД, указанных таблиц по всем БД или указанным колонкам по всем
                        таблицам БД. Это полезно, например, для идентификации таблиц, содержащих пользовательские
                        учётные данные приложений, где колонки с соответствующими именами колонок содержат такие строки
                        как имя и пароль.
                    </li>
                    <li>
                        Поддержка загрузки и выгрузки любого файла из файловой системы с сервера БД, когда ПО БД MySQL,
                        PostgreSQL или Microsoft SQL Server.
                    </li>
                    <li>
                        Поддержка выполнения произвольных команд на ОС сервера БД и получение их стандартного вывода
                        когда ПО MySQL, PostgreSQL или Microsoft SQL Server.
                    </li>
                    <li>
                        Поддержка установления внедиапазонного TCP подключения между атакующей машиной и лежащей в
                        основе сервера базы данных операционной системой. Этот канал по выбору пользователя может быть
                        интерактивным приглашением командной строки, сессией Meterpreter или сессией графического
                        пользовательского интерфейса (VNC).
                    </li>
                    <li>
                        Поддержка повышения пользовательских привилегий процесса базы данных через команду Metasploit&#39;а
                        - Meterpreter getsystem.
                    </li>
                </ul>

                <b>
                    Примеры запуска sqlmap<br/>
                </b>
                <p>
                    Перечислить базы данных <em><strong>(--dbs)</strong></em> для сайта
                    http://www.sqldummywebsite.name/rubrika.php?id=31 <em><strong>(-u
                    http://www.sqldummywebsite.name/rubrika.php?id=31)</strong></em>
                </p>
                <pre class="prettyprint lang-bash">
sqlmap -u http://www.sqldummywebsite.name/rubrika.php?id=31 --dbs</pre>
                <p>
                    Построить список таблиц <em><strong>(--tables)</strong></em> для базы данных laminat <em><strong>(-D
                    laminat)</strong></em> для сайта http://www.sqldummywebsite.name/rubrika.php?id=31 <strong>(-u
                    http://www.sqldummywebsite.name/rubrika.php?id=31)</strong>
                </p>
                <pre class="prettyprint lang-bash">
sqlmap -u www.sqldummywebsite.name/rubrika.php?id=31 -D laminat --tables</pre>
                <h4>Hydra</h4>
                <p>Очень часто самым началом или концом теста приложения на безопасность
                    является подбор паролей. Сервисы, к которым можно применить данный метод атаки - самые различные. А
                    как следствие - различны и протоколы, и форматы обращений. Для унификации этой задачи есть отичный
                    инструмент - THC-Hydra. Версия 7.5
                    (из репозитория epel) поддерживает подбор по/для: asterisk cisco cisco-enable cvs firebird ftp ftps
                    http[s]-{head|get} http[s]-{get|post}-form http-proxy http-proxy-urlenum icq imap[s] irc ldap2[s]
                    ldap3[-{cram|digest}md5][s] mssql mysql nntp oracle-listener oracle-sid pcanywhere pcnfs pop3[s]
                    postgres rdp rexec rlogin rsh sip smb smtp[s] smtp-enum snmp socks5 ssh sshkey svn teamspeak
                    telnet[s] vmauthd vnc xmpp.</p>
                <p> В качестве примера работы - предположим следующие исходные данные:

                </p>
                <ul>
                    <li>IP сервера 178.72.90.181;
                    </li>
                    <li>Сервис http на стандартном 80 порту;
                    </li>
                    <li>Для авторизации используется html форма, которая отправляет по адресу
                        http://178.72.90.181/cgi-bin/luci методом POST запрос вида username=root&password=test_password;
                    </li>
                    <li>В случае не удачной аутентификации пользователь наблюдает сообщение Invalid username and/or
                        password! Please try again.;
                    </li>
                </ul>
                <p>Тогда запрос к гидре будет выглядеть примерно так:</p>

                <pre class="prettyprint lang-bash">
hydra -l root -P ~/pass_lists/dedik_passes.txt -o ./hydra_result.log -f -V -s 80 178.72.90.181
http-post-form "/cgi-bin/luci:username=^USER^&password=^PASS^:Invalid username"
                </pre>
                Мы используем http-post-form потому как авторизация происходит по http
                методом post. После указания этого модуля идет строка
                /cgi-bin/luci:username=^USER^&password=^PASS^:Invalid username, у которой через двоеточие (:)
                указывается:

                <ul>
                    <li>Путь до скрипта, который обрабатывает процесс аутентификации. В нашем случае это /cgi-bin/luci;
                    </li>
                    <li>
                        Строка, которая передается методом POST, в которой логин и пароль заменены на ^USER^ и ^PASS^
                        соответственно. У нас это username=^USER^&password=^PASS^;
                    </li>
                    <li>Строка, которая присутствует на странице при неудачной аутентификации. При её отсутствии гидра
                        поймет
                        что мы успешно вошли. В нашем случае это Invalid username;
                    </li>
                </ul>
                <h3 id="task">Задание</h3>
                <ul>
                    <li>Установить Kali Linux (в качестве виртуальной машины) или воспользоваться дистрибутивом в
                        классе. Скачать образ можно с официального сайта
                        <a href="https://www.kali.org/downloads/">https://www.kali.org/downloads/</a>.
                    </li>
                    <li>Установить DVWA из форка <a href="https://github.com/jehy/DVWA">https://github.com/jehy/DVWA</a>
                        согласно инструкциям и видео, поставить
                        "средний" уровнь безопасности;
                    </li>
                    <li>Провести внешнее тестирование приложения (не пользуясь его исходным кодом); В результате должно
                        быть найдено не менее 4х различных типов уязвимостей.
                    </li>
                    <li>Дополнить результаты внешнего тестирования результатами анализа кода приложения</li>
                </ul>
                <h3 id="questions">Контрольные вопросы:</h3>

                <p>
                <ul>
                    <li>Можно ли ставить DVWA на свой публичный веб сервер?
                    </li>
                    <li>Чем отличается тестирование DVWA от тестирования публичного сервера?
                    </li>
                    <li>Что представляет собой дистрибутив Kali Linux?
                    </li>
                    <li>Перечислите и опишите вкратце несколько компонентов, входящих в состав Kali Linux;
                    </li>
                </ul>
            </div>
        </div>
    </section>
</div>
<script src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/prettify/prettify.js"></script>
<script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?lang=css&skin=sunburst"></script>
<script src="js/layout.js"></script>
</body>
</html>

